import{r as h,j as se}from"./index-B0DnFx1G.js";import{j as ut,u as pt,p as et,h as dt,a as ct,T as ht,m as mt,L as ft,t as bt}from"./image-BHKI4BDm.js";import{S as gt}from"./meta-BpWbT_-_.js";import{u as yt}from"./useWindowSize-BLpVEtdB.js";import{E as Et,l as $,s as tt,Q as nt,O as He,V as oe,e as je,u as Re,T as Pe,R as wt,v as _t,w as Tt,H as Se,F as Ue,x as Ye,b as Oe,y as Rt,z as Pt,B as St,I as Mt,W as At,h as ot,o as vt,S as xt,J as Lt,K as Dt,A as jt,D as Ot,r as Ct,c as kt,a as It,N as Ve,q as Nt,X as Ft,Y as zt,t as Ht,Z as Yt,m as Bt,_ as Ut}from"./three-lAf56tG-.js";import{c as rt}from"./clamp-e7DugykH.js";import{t as Gt}from"./throttle-BgiUmwhn.js";import{u as _e}from"./use-spring-DegSYzPR.js";import"./components-HTtfmZgm.js";import"./config-DqxGbUba.js";import"./index-Sos_u0WN.js";var Vt=Object.defineProperty,Zt=(g,s,_)=>s in g?Vt(g,s,{enumerable:!0,configurable:!0,writable:!0,value:_}):g[s]=_,p=(g,s,_)=>(Zt(g,typeof s!="symbol"?s+"":s,_),_);const Be=new wt,at=new _t,Xt=Math.cos(70*(Math.PI/180)),st=(g,s)=>(g%s+s)%s;class Wt extends Et{constructor(s,_){super(),p(this,"object"),p(this,"domElement"),p(this,"enabled",!0),p(this,"target",new $),p(this,"minDistance",0),p(this,"maxDistance",1/0),p(this,"minZoom",0),p(this,"maxZoom",1/0),p(this,"minPolarAngle",0),p(this,"maxPolarAngle",Math.PI),p(this,"minAzimuthAngle",-1/0),p(this,"maxAzimuthAngle",1/0),p(this,"enableDamping",!1),p(this,"dampingFactor",.05),p(this,"enableZoom",!0),p(this,"zoomSpeed",1),p(this,"enableRotate",!0),p(this,"rotateSpeed",1),p(this,"enablePan",!0),p(this,"panSpeed",1),p(this,"screenSpacePanning",!0),p(this,"keyPanSpeed",7),p(this,"zoomToCursor",!1),p(this,"autoRotate",!1),p(this,"autoRotateSpeed",2),p(this,"reverseOrbit",!1),p(this,"reverseHorizontalOrbit",!1),p(this,"reverseVerticalOrbit",!1),p(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),p(this,"mouseButtons",{LEFT:Re.ROTATE,MIDDLE:Re.DOLLY,RIGHT:Re.PAN}),p(this,"touches",{ONE:Pe.ROTATE,TWO:Pe.DOLLY_PAN}),p(this,"target0"),p(this,"position0"),p(this,"zoom0"),p(this,"_domElementKeyEvents",null),p(this,"getPolarAngle"),p(this,"getAzimuthalAngle"),p(this,"setPolarAngle"),p(this,"setAzimuthalAngle"),p(this,"getDistance"),p(this,"listenToKeyEvents"),p(this,"stopListenToKeyEvents"),p(this,"saveState"),p(this,"reset"),p(this,"update"),p(this,"connect"),p(this,"dispose"),this.object=s,this.domElement=_,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>E.phi,this.getAzimuthalAngle=()=>E.theta,this.setPolarAngle=t=>{let n=st(t,2*Math.PI),d=E.phi;d<0&&(d+=2*Math.PI),n<0&&(n+=2*Math.PI);let S=Math.abs(n-d);2*Math.PI-S<S&&(n<d?n+=2*Math.PI:d+=2*Math.PI),k.phi=n-d,e.update()},this.setAzimuthalAngle=t=>{let n=st(t,2*Math.PI),d=E.theta;d<0&&(d+=2*Math.PI),n<0&&(n+=2*Math.PI);let S=Math.abs(n-d);2*Math.PI-S<S&&(n<d?n+=2*Math.PI:d+=2*Math.PI),k.theta=n-d,e.update()},this.getDistance=()=>e.object.position.distanceTo(e.target),this.listenToKeyEvents=t=>{t.addEventListener("keydown",X),this._domElementKeyEvents=t},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",X),this._domElementKeyEvents=null},this.saveState=()=>{e.target0.copy(e.target),e.position0.copy(e.object.position),e.zoom0=e.object.zoom},this.reset=()=>{e.target.copy(e.target0),e.object.position.copy(e.position0),e.object.zoom=e.zoom0,e.object.updateProjectionMatrix(),e.dispatchEvent(W),e.update(),y=c.NONE},this.update=(()=>{const t=new $,n=new $(0,1,0),d=new nt().setFromUnitVectors(s.up,n),S=d.clone().invert(),Y=new $,le=new nt,ge=2*Math.PI;return function(){const Qe=e.object.position;d.setFromUnitVectors(s.up,n),S.copy(d).invert(),t.copy(Qe).sub(e.target),t.applyQuaternion(d),E.setFromVector3(t),e.autoRotate&&y===c.NONE&&K(J()),e.enableDamping?(E.theta+=k.theta*e.dampingFactor,E.phi+=k.phi*e.dampingFactor):(E.theta+=k.theta,E.phi+=k.phi);let ue=e.minAzimuthAngle,pe=e.maxAzimuthAngle;isFinite(ue)&&isFinite(pe)&&(ue<-Math.PI?ue+=ge:ue>Math.PI&&(ue-=ge),pe<-Math.PI?pe+=ge:pe>Math.PI&&(pe-=ge),ue<=pe?E.theta=Math.max(ue,Math.min(pe,E.theta)):E.theta=E.theta>(ue+pe)/2?Math.max(ue,E.theta):Math.min(pe,E.theta)),E.phi=Math.max(e.minPolarAngle,Math.min(e.maxPolarAngle,E.phi)),E.makeSafe(),e.enableDamping===!0?e.target.addScaledVector(Q,e.dampingFactor):e.target.add(Q),e.zoomToCursor&&u||e.object.isOrthographicCamera?E.radius=ne(E.radius):E.radius=ne(E.radius*z),t.setFromSpherical(E),t.applyQuaternion(S),Qe.copy(e.target).add(t),e.object.matrixAutoUpdate||e.object.updateMatrix(),e.object.lookAt(e.target),e.enableDamping===!0?(k.theta*=1-e.dampingFactor,k.phi*=1-e.dampingFactor,Q.multiplyScalar(1-e.dampingFactor)):(k.set(0,0,0),Q.set(0,0,0));let xe=!1;if(e.zoomToCursor&&u){let Le=null;if(e.object instanceof je&&e.object.isPerspectiveCamera){const De=t.length();Le=ne(De*z);const ze=De-Le;e.object.position.addScaledVector(M,ze),e.object.updateMatrixWorld()}else if(e.object.isOrthographicCamera){const De=new $(i.x,i.y,0);De.unproject(e.object),e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/z)),e.object.updateProjectionMatrix(),xe=!0;const ze=new $(i.x,i.y,0);ze.unproject(e.object),e.object.position.sub(ze).add(De),e.object.updateMatrixWorld(),Le=t.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),e.zoomToCursor=!1;Le!==null&&(e.screenSpacePanning?e.target.set(0,0,-1).transformDirection(e.object.matrix).multiplyScalar(Le).add(e.object.position):(Be.origin.copy(e.object.position),Be.direction.set(0,0,-1).transformDirection(e.object.matrix),Math.abs(e.object.up.dot(Be.direction))<Xt?s.lookAt(e.target):(at.setFromNormalAndCoplanarPoint(e.object.up,e.target),Be.intersectPlane(at,e.target))))}else e.object instanceof He&&e.object.isOrthographicCamera&&(xe=z!==1,xe&&(e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/z)),e.object.updateProjectionMatrix()));return z=1,u=!1,xe||Y.distanceToSquared(e.object.position)>B||8*(1-le.dot(e.object.quaternion))>B?(e.dispatchEvent(W),Y.copy(e.object.position),le.copy(e.object.quaternion),xe=!1,!0):!1}})(),this.connect=t=>{t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),e.domElement=t,e.domElement.style.touchAction="none",e.domElement.addEventListener("contextmenu",ve),e.domElement.addEventListener("pointerdown",F),e.domElement.addEventListener("pointercancel",m),e.domElement.addEventListener("wheel",be)},this.dispose=()=>{var t,n,d,S,Y,le;(t=e.domElement)==null||t.removeEventListener("contextmenu",ve),(n=e.domElement)==null||n.removeEventListener("pointerdown",F),(d=e.domElement)==null||d.removeEventListener("pointercancel",m),(S=e.domElement)==null||S.removeEventListener("wheel",be),(Y=e.domElement)==null||Y.ownerDocument.removeEventListener("pointermove",Z),(le=e.domElement)==null||le.ownerDocument.removeEventListener("pointerup",w),e._domElementKeyEvents!==null&&e._domElementKeyEvents.removeEventListener("keydown",X)};const e=this,W={type:"change"},T={type:"start"},f={type:"end"},c={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let y=c.NONE;const B=1e-6,E=new tt,k=new tt;let z=1;const Q=new $,A=new oe,j=new oe,ee=new oe,H=new oe,O=new oe,o=new oe,a=new oe,R=new oe,b=new oe,M=new $,i=new oe;let u=!1;const r=[],l={};function J(){return 2*Math.PI/60/60*e.autoRotateSpeed}function re(){return Math.pow(.95,e.zoomSpeed)}function K(t){e.reverseOrbit||e.reverseHorizontalOrbit?k.theta+=t:k.theta-=t}function L(t){e.reverseOrbit||e.reverseVerticalOrbit?k.phi+=t:k.phi-=t}const he=(()=>{const t=new $;return function(d,S){t.setFromMatrixColumn(S,0),t.multiplyScalar(-d),Q.add(t)}})(),G=(()=>{const t=new $;return function(d,S){e.screenSpacePanning===!0?t.setFromMatrixColumn(S,1):(t.setFromMatrixColumn(S,0),t.crossVectors(e.object.up,t)),t.multiplyScalar(d),Q.add(t)}})(),I=(()=>{const t=new $;return function(d,S){const Y=e.domElement;if(Y&&e.object instanceof je&&e.object.isPerspectiveCamera){const le=e.object.position;t.copy(le).sub(e.target);let ge=t.length();ge*=Math.tan(e.object.fov/2*Math.PI/180),he(2*d*ge/Y.clientHeight,e.object.matrix),G(2*S*ge/Y.clientHeight,e.object.matrix)}else Y&&e.object instanceof He&&e.object.isOrthographicCamera?(he(d*(e.object.right-e.object.left)/e.object.zoom/Y.clientWidth,e.object.matrix),G(S*(e.object.top-e.object.bottom)/e.object.zoom/Y.clientHeight,e.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),e.enablePan=!1)}})();function te(t){e.object instanceof je&&e.object.isPerspectiveCamera||e.object instanceof He&&e.object.isOrthographicCamera?z/=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function Te(t){e.object instanceof je&&e.object.isPerspectiveCamera||e.object instanceof He&&e.object.isOrthographicCamera?z*=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function ye(t){if(!e.zoomToCursor||!e.domElement)return;u=!0;const n=e.domElement.getBoundingClientRect(),d=t.clientX-n.left,S=t.clientY-n.top,Y=n.width,le=n.height;i.x=d/Y*2-1,i.y=-(S/le)*2+1,M.set(i.x,i.y,1).unproject(e.object).sub(e.object.position).normalize()}function ne(t){return Math.max(e.minDistance,Math.min(e.maxDistance,t))}function ae(t){A.set(t.clientX,t.clientY)}function ie(t){ye(t),a.set(t.clientX,t.clientY)}function me(t){H.set(t.clientX,t.clientY)}function Ee(t){j.set(t.clientX,t.clientY),ee.subVectors(j,A).multiplyScalar(e.rotateSpeed);const n=e.domElement;n&&(K(2*Math.PI*ee.x/n.clientHeight),L(2*Math.PI*ee.y/n.clientHeight)),A.copy(j),e.update()}function we(t){R.set(t.clientX,t.clientY),b.subVectors(R,a),b.y>0?te(re()):b.y<0&&Te(re()),a.copy(R),e.update()}function fe(t){O.set(t.clientX,t.clientY),o.subVectors(O,H).multiplyScalar(e.panSpeed),I(o.x,o.y),H.copy(O),e.update()}function Me(t){ye(t),t.deltaY<0?Te(re()):t.deltaY>0&&te(re()),e.update()}function Ce(t){let n=!1;switch(t.code){case e.keys.UP:I(0,e.keyPanSpeed),n=!0;break;case e.keys.BOTTOM:I(0,-e.keyPanSpeed),n=!0;break;case e.keys.LEFT:I(e.keyPanSpeed,0),n=!0;break;case e.keys.RIGHT:I(-e.keyPanSpeed,0),n=!0;break}n&&(t.preventDefault(),e.update())}function ke(){if(r.length==1)A.set(r[0].pageX,r[0].pageY);else{const t=.5*(r[0].pageX+r[1].pageX),n=.5*(r[0].pageY+r[1].pageY);A.set(t,n)}}function Ie(){if(r.length==1)H.set(r[0].pageX,r[0].pageY);else{const t=.5*(r[0].pageX+r[1].pageX),n=.5*(r[0].pageY+r[1].pageY);H.set(t,n)}}function P(){const t=r[0].pageX-r[1].pageX,n=r[0].pageY-r[1].pageY,d=Math.sqrt(t*t+n*n);a.set(0,d)}function v(){e.enableZoom&&P(),e.enablePan&&Ie()}function D(){e.enableZoom&&P(),e.enableRotate&&ke()}function U(t){if(r.length==1)j.set(t.pageX,t.pageY);else{const d=Ge(t),S=.5*(t.pageX+d.x),Y=.5*(t.pageY+d.y);j.set(S,Y)}ee.subVectors(j,A).multiplyScalar(e.rotateSpeed);const n=e.domElement;n&&(K(2*Math.PI*ee.x/n.clientHeight),L(2*Math.PI*ee.y/n.clientHeight)),A.copy(j)}function V(t){if(r.length==1)O.set(t.pageX,t.pageY);else{const n=Ge(t),d=.5*(t.pageX+n.x),S=.5*(t.pageY+n.y);O.set(d,S)}o.subVectors(O,H).multiplyScalar(e.panSpeed),I(o.x,o.y),H.copy(O)}function N(t){const n=Ge(t),d=t.pageX-n.x,S=t.pageY-n.y,Y=Math.sqrt(d*d+S*S);R.set(0,Y),b.set(0,Math.pow(R.y/a.y,e.zoomSpeed)),te(b.y),a.copy(R)}function x(t){e.enableZoom&&N(t),e.enablePan&&V(t)}function ce(t){e.enableZoom&&N(t),e.enableRotate&&U(t)}function F(t){var n,d;e.enabled!==!1&&(r.length===0&&((n=e.domElement)==null||n.ownerDocument.addEventListener("pointermove",Z),(d=e.domElement)==null||d.ownerDocument.addEventListener("pointerup",w)),Fe(t),t.pointerType==="touch"?Ae(t):C(t))}function Z(t){e.enabled!==!1&&(t.pointerType==="touch"?Ne(t):q(t))}function w(t){var n,d,S;$e(t),r.length===0&&((n=e.domElement)==null||n.releasePointerCapture(t.pointerId),(d=e.domElement)==null||d.ownerDocument.removeEventListener("pointermove",Z),(S=e.domElement)==null||S.ownerDocument.removeEventListener("pointerup",w)),e.dispatchEvent(f),y=c.NONE}function m(t){$e(t)}function C(t){let n;switch(t.button){case 0:n=e.mouseButtons.LEFT;break;case 1:n=e.mouseButtons.MIDDLE;break;case 2:n=e.mouseButtons.RIGHT;break;default:n=-1}switch(n){case Re.DOLLY:if(e.enableZoom===!1)return;ie(t),y=c.DOLLY;break;case Re.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enablePan===!1)return;me(t),y=c.PAN}else{if(e.enableRotate===!1)return;ae(t),y=c.ROTATE}break;case Re.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enableRotate===!1)return;ae(t),y=c.ROTATE}else{if(e.enablePan===!1)return;me(t),y=c.PAN}break;default:y=c.NONE}y!==c.NONE&&e.dispatchEvent(T)}function q(t){if(e.enabled!==!1)switch(y){case c.ROTATE:if(e.enableRotate===!1)return;Ee(t);break;case c.DOLLY:if(e.enableZoom===!1)return;we(t);break;case c.PAN:if(e.enablePan===!1)return;fe(t);break}}function be(t){e.enabled===!1||e.enableZoom===!1||y!==c.NONE&&y!==c.ROTATE||(t.preventDefault(),e.dispatchEvent(T),Me(t),e.dispatchEvent(f))}function X(t){e.enabled===!1||e.enablePan===!1||Ce(t)}function Ae(t){switch(Je(t),r.length){case 1:switch(e.touches.ONE){case Pe.ROTATE:if(e.enableRotate===!1)return;ke(),y=c.TOUCH_ROTATE;break;case Pe.PAN:if(e.enablePan===!1)return;Ie(),y=c.TOUCH_PAN;break;default:y=c.NONE}break;case 2:switch(e.touches.TWO){case Pe.DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;v(),y=c.TOUCH_DOLLY_PAN;break;case Pe.DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;D(),y=c.TOUCH_DOLLY_ROTATE;break;default:y=c.NONE}break;default:y=c.NONE}y!==c.NONE&&e.dispatchEvent(T)}function Ne(t){switch(Je(t),y){case c.TOUCH_ROTATE:if(e.enableRotate===!1)return;U(t),e.update();break;case c.TOUCH_PAN:if(e.enablePan===!1)return;V(t),e.update();break;case c.TOUCH_DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;x(t),e.update();break;case c.TOUCH_DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;ce(t),e.update();break;default:y=c.NONE}}function ve(t){e.enabled!==!1&&t.preventDefault()}function Fe(t){r.push(t)}function $e(t){delete l[t.pointerId];for(let n=0;n<r.length;n++)if(r[n].pointerId==t.pointerId){r.splice(n,1);return}}function Je(t){let n=l[t.pointerId];n===void 0&&(n=new oe,l[t.pointerId]=n),n.set(t.pageX,t.pageY)}function Ge(t){const n=t.pointerId===r[0].pointerId?r[1]:r[0];return l[n.pointerId]}_!==void 0&&this.connect(_),this.update()}}class Kt extends Tt{constructor(s){super(s),this.type=Se}parse(s){const c=function(o,a){switch(o){case 1:console.error("THREE.RGBELoader Read Error: "+(a||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(a||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(a||""));break;default:case 4:console.error("THREE.RGBELoader: Error: "+(a||""))}return-1},z=function(o,a,R){a=a||1024;let M=o.pos,i=-1,u=0,r="",l=String.fromCharCode.apply(null,new Uint16Array(o.subarray(M,M+128)));for(;0>(i=l.indexOf(`
`))&&u<a&&M<o.byteLength;)r+=l,u+=l.length,M+=128,l+=String.fromCharCode.apply(null,new Uint16Array(o.subarray(M,M+128)));return-1<i?(o.pos+=u+i+1,r+l.slice(0,i)):!1},Q=function(o){const a=/^#\?(\S+)/,R=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,b=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,M=/^\s*FORMAT=(\S+)\s*$/,i=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,u={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let r,l;if(o.pos>=o.byteLength||!(r=z(o)))return c(1,"no header found");if(!(l=r.match(a)))return c(3,"bad initial token");for(u.valid|=1,u.programtype=l[1],u.string+=r+`
`;r=z(o),r!==!1;){if(u.string+=r+`
`,r.charAt(0)==="#"){u.comments+=r+`
`;continue}if((l=r.match(R))&&(u.gamma=parseFloat(l[1])),(l=r.match(b))&&(u.exposure=parseFloat(l[1])),(l=r.match(M))&&(u.valid|=2,u.format=l[1]),(l=r.match(i))&&(u.valid|=4,u.height=parseInt(l[1],10),u.width=parseInt(l[2],10)),u.valid&2&&u.valid&4)break}return u.valid&2?u.valid&4?u:c(3,"missing image size specifier"):c(3,"missing format specifier")},A=function(o,a,R){const b=a;if(b<8||b>32767||o[0]!==2||o[1]!==2||o[2]&128)return new Uint8Array(o);if(b!==(o[2]<<8|o[3]))return c(3,"wrong scanline width");const M=new Uint8Array(4*a*R);if(!M.length)return c(4,"unable to allocate buffer space");let i=0,u=0;const r=4*b,l=new Uint8Array(4),J=new Uint8Array(r);let re=R;for(;re>0&&u<o.byteLength;){if(u+4>o.byteLength)return c(1);if(l[0]=o[u++],l[1]=o[u++],l[2]=o[u++],l[3]=o[u++],l[0]!=2||l[1]!=2||(l[2]<<8|l[3])!=b)return c(3,"bad rgbe scanline format");let K=0,L;for(;K<r&&u<o.byteLength;){L=o[u++];const G=L>128;if(G&&(L-=128),L===0||K+L>r)return c(3,"bad scanline data");if(G){const I=o[u++];for(let te=0;te<L;te++)J[K++]=I}else J.set(o.subarray(u,u+L),K),K+=L,u+=L}const he=b;for(let G=0;G<he;G++){let I=0;M[i]=J[G+I],I+=b,M[i+1]=J[G+I],I+=b,M[i+2]=J[G+I],I+=b,M[i+3]=J[G+I],i+=4}re--}return M},j=function(o,a,R,b){const M=o[a+3],i=Math.pow(2,M-128)/255;R[b+0]=o[a+0]*i,R[b+1]=o[a+1]*i,R[b+2]=o[a+2]*i,R[b+3]=1},ee=function(o,a,R,b){const M=o[a+3],i=Math.pow(2,M-128)/255;R[b+0]=Ye.toHalfFloat(Math.min(o[a+0]*i,65504)),R[b+1]=Ye.toHalfFloat(Math.min(o[a+1]*i,65504)),R[b+2]=Ye.toHalfFloat(Math.min(o[a+2]*i,65504)),R[b+3]=Ye.toHalfFloat(1)},H=new Uint8Array(s);H.pos=0;const O=Q(H);if(O!==-1){const o=O.width,a=O.height,R=A(H.subarray(H.pos),o,a);if(R!==-1){let b,M,i;switch(this.type){case Ue:i=R.length/4;const u=new Float32Array(i*4);for(let l=0;l<i;l++)j(R,l*4,u,l*4);b=u,M=Ue;break;case Se:i=R.length/4;const r=new Uint16Array(i*4);for(let l=0;l<i;l++)ee(R,l*4,r,l*4);b=r,M=Se;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type);break}return{width:o,height:a,data:b,header:O.string,gamma:O.gamma,exposure:O.exposure,type:M}}}return null}setDataType(s){return this.type=s,this}load(s,_,e,W){function T(f,c){switch(f.type){case Ue:case Se:"colorSpace"in f?f.colorSpace="srgb-linear":f.encoding=3e3,f.minFilter=Oe,f.magFilter=Oe,f.generateMipmaps=!1,f.flipY=!0;break}_&&_(f,c)}return super.load(s,T,e,W)}}class qt extends Rt{constructor(s){super(s),this.hdrLoader=new Kt,this.type=Se}load(s,_,e,W){typeof s=="string"?s=[s]:Array.isArray(s)||(console.warn("THREE.HDRCubeTextureLoader signature has changed. Use .setDataType() instead."),this.setDataType(s),s=_,_=e,e=W,W=arguments[4]);const T=new Pt;switch(T.type=this.type,T.type){case Ue:case Se:"colorSpace"in T?T.colorSpace="srgb-linear":T.encoding=3e3,T.minFilter=Oe,T.magFilter=Oe,T.generateMipmaps=!1;break}const f=this;let c=0;function y(B,E,k,z){new St(f.manager).setPath(f.path).setResponseType("arraybuffer").setWithCredentials(f.withCredentials).load(s[B],function(Q){c++;const A=f.hdrLoader.parse(Q);if(A){if(A.data!==void 0){const j=new Mt(A.data,A.width,A.height);j.type=T.type,"colorSpace"in j?j.colorSpace=T.SRGBColorSpace:j.encoding=T.encoding,j.format=T.format,j.minFilter=T.minFilter,j.magFilter=T.magFilter,j.generateMipmaps=T.generateMipmaps,T.images[B]=j}c===6&&(T.needsUpdate=!0,E&&E(T))}},k,z)}for(let B=0;B<s.length;B++)y(B,_,e,W);return T}setDataType(s){return this.type=s,this.hdrLoader.setDataType(s),this}}const $t="/assets/earth-DvZudj9K.glb",Jt="/assets/milkyway-nx-Ds_hwpSC.hdr",Qt="/assets/milkyway-ny-BqhFvupA.hdr",en="/assets/milkyway-nz-D6l6T-pv.hdr",tn="/assets/milkyway-px-BjIdbMt0.hdr",nn="/assets/milkyway-py-BD6pEbZF.hdr",on="/assets/milkyway-pz-Bx3WFS88.hdr",rn="/assets/milkyway-Vkpv7LbT.jpg",an="_earth_1awhs_1",sn="_loader_1awhs_8",cn="_viewport_1awhs_22",ln="_canvas_1awhs_33",un="_labels_1awhs_52",pn="_label_1awhs_52",dn="_vignette_1awhs_82",hn="_sections_1awhs_94",mn="_section_1awhs_94",de={earth:an,loader:sn,viewport:cn,canvas:ln,labels:un,label:pn,vignette:dn,sections:hn,section:mn},qe={x:0,y:0,z:2},Ze=(g,s,_)=>g+_*(s-g),it=g=>Object.keys(g).map(s=>parseFloat(Math.round(g[s]*100)/100).toFixed(2)).join(", "),Xe=g=>!g||!g.camera?qe:{x:g.camera[0],y:g.camera[1],z:g.camera[2]},fn=(g,s)=>{const _=(e=0)=>Math.round((e+Number.EPSILON)*100)/100;return _(g?.x)===_(s?.x)&&_(g?.y)===_(s?.y)&&_(g?.z)===_(s?.z)},We={stiffness:80,damping:40,mass:2,restSpeed:.001,restDelta:.001},Ke={stiffness:40,damping:30,mass:2,restSpeed:.001,restDelta:.001},bn={stiffness:40,damping:30},lt=h.createContext({}),xn=({position:g=[0,0,0],scale:s=1,hideMeshes:_=[],labels:e=[],className:W,children:T})=>{const[f,c]=h.useState(!1),[y,B]=h.useState(!1),[E,k]=h.useState(!1),[z,Q]=h.useState(!1),A=h.useRef([]),j=h.useRef(),ee=h.useRef(),H=h.useRef(),O=h.useRef(),o=h.useRef(),a=h.useRef(),R=h.useRef(),b=h.useRef(),M=h.useRef(),i=h.useRef(),u=h.useRef(),r=h.useRef(),l=ut(H),J=h.useRef(),re=h.useRef(Xe(A.current[0])),K=h.useRef([]),L=h.useRef(),he=h.useRef(),G=h.useRef(),I=h.useRef(),{width:te,height:Te}=yt(),ye=pt(),ne=_e(0,We),ae=_e(0,We),ie=_e(0,We),me=_e(0,Ke),Ee=_e(0,Ke),we=_e(0,Ke),fe=_e(0,bn),Me=h.useCallback(()=>{if(!l){cancelAnimationFrame(J.current);return}J.current=requestAnimationFrame(Me);const P=R.current.getDelta();r.current.update(P),L.current.update(),o.current.render(O.current,a.current),K.current.forEach(v=>{const{element:D,position:U,sprite:V}=v,N=new $(...U),x=a.current.position.distanceTo(i.current.position),F=a.current.position.distanceTo(V.position)>x;N.project(a.current),N.x=Math.round((.5+N.x/2)*window.innerWidth),N.y=Math.round((.5-N.y/2)*window.innerHeight),D.style.setProperty("--posX",et(N.x)),D.style.setProperty("--posY",et(N.y)),F?D.dataset.occluded=!0:D.dataset.occluded=!1})},[l]);h.useEffect(()=>{I.current=!0;const{innerWidth:P,innerHeight:v}=window;o.current=new At({canvas:H.current,antialias:!1,alpha:!0,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!0}),o.current.setPixelRatio(1),o.current.outputColorSpace=ot,o.current.toneMapping=vt,a.current=new je(54,P/v,.1,100),a.current.position.x=re.current.x,a.current.position.y=re.current.y,a.current.position.z=re.current.z,a.current.lookAt(0,0,0),ne.set(a.current.position.x,!1),ae.set(a.current.position.y,!1),ie.set(a.current.position.z,!1),O.current=new xt,R.current=new Lt,M.current=new Dt;const D=new jt(2236962,.05),U=new Ot(16777215,1.5);U.position.set(3,0,1);const V=[D,U];return V.forEach(N=>O.current.add(N)),L.current=new Wt(a.current,H.current),L.current.enableZoom=!1,L.current.enablePan=!1,L.current.enableDamping=!1,L.current.rotateSpeed=.5,()=>{I.current=!1,cancelAnimationFrame(J.current),Ct(V),kt(O.current),It(o.current)}},[]),h.useEffect(()=>{const P=()=>{B(!0),ne.stop(),ae.stop(),ie.stop()},v=()=>{ne.set(a.current.position.x,!1),ae.set(a.current.position.y,!1),ie.set(a.current.position.z,!1),B(!1)};return L.current.addEventListener("start",P),L.current.addEventListener("end",v),()=>{L.current.removeEventListener("start",P),L.current.removeEventListener("end",v)}},[ne,ae,ie]),h.useEffect(()=>{if(!f)return;const P=Ve("Chunk",i.current),v=Ve("Atmosphere",i.current),D=(m,C)=>{a.current.position[m]=C},U=ne.on("change",m=>D("x",m)),V=ae.on("change",m=>D("y",m)),N=ie.on("change",m=>D("z",m)),x=(m,C)=>{P.position[m]=C},ce=me.on("change",m=>x("x",m)),F=Ee.on("change",m=>x("y",m)),Z=we.on("change",m=>x("z",m)),w=fe.on("change",m=>{v.material.opacity=m});return()=>{U(),V(),N(),ce(),F(),Z(),w()}},[ne,ae,ie,me,Ee,we,f,fe]),h.useEffect(()=>{te<=dt.tablet&&(L.current.enabled=!1)},[te]),h.useEffect(()=>{if(f)return;const P=new qt,v=new Nt(o.current);v.compileCubemapShader();const D=async()=>{const x=await Bt.loadAsync($t);i.current=x.scene,u.current=x.animations,r.current=new Ut(i.current),r.current.timeScale=.1,i.current.traverse(async ce=>{const{material:F,name:Z}=ce;Z==="Atmosphere"&&(F.alphaMap=F.map),F&&await o.current.initTexture(F)}),i.current.position.x=g[0],i.current.position.y=g[1],i.current.position.z=g[2],i.current.scale.x=s,i.current.scale.y=s,i.current.scale.z=s},U=async()=>{const x=await P.loadAsync([Jt,Qt,en,tn,nn,on]);x.magFilter=Oe,he.current=v.fromCubemap(x),v.dispose(),await o.current.initTexture(he.current.texture)},V=async()=>{const x=await Ht.loadAsync(rn);x.mapping=Yt,x.colorSpace=ot,O.current.background=x,await o.current.initTexture(x)},N=async()=>{await Promise.all([V(),U(),D()]),i.current.traverse(({material:x})=>{x&&(x.envMap=he.current.texture,x.needsUpdate=!0)}),I.current&&c(!0)};h.startTransition(()=>{N(),setTimeout(()=>{Q(!0)},1e3)})},[f,g,s]),h.useEffect(()=>(f&&!G.current&&(O.current.add(i.current),G.current=!0),f&&l&&(k(!0),Me()),()=>{cancelAnimationFrame(J.current)}),[Me,l,f]),h.useEffect(()=>{f&&(ee.current.innerHTML="",K.current=e.map(P=>{const v=document.createElement("div");v.classList.add(de.label),v.dataset.hidden=!0,v.style.setProperty("--delay",`${P.delay||0}ms`),v.textContent=P.text,ee.current.appendChild(v);const D=new Ft;return D.position.set(...P.position),D.scale.set(60,60,1),{element:v,...P,sprite:D}}))},[e,f]),h.useEffect(()=>{o.current.setSize(te,Te),a.current.aspect=te/Te,a.current.updateProjectionMatrix()},[te,Te]),h.useEffect(()=>{const P=H.current,v=D=>{const{innerWidth:U,innerHeight:V}=window,N=it(a.current.position);console.info({cameraPosition:N}),b.current=new oe(D.clientX/U*2-1,-(D.clientY/V)*2+1),M.current.setFromCamera(b.current,a.current);const x=M.current.intersectObjects(O.current.children,!0);if(x.length>0){const ce=it(x[0].point);console.info({clickPosition:ce})}};return()=>{P.removeEventListener("click",v)}},[]);const Ce=h.useCallback(()=>{if(!j.current)return;const{offsetTop:P}=j.current,{innerHeight:v}=window,D=window.scrollY-P;let U;const V=F=>{const Z=A.current[F].meshes;i.current.traverse(w=>{const{name:m}=w,C=Ve("Chunk",i.current),q=Z?.includes(m),be=_?.includes(m);if(q)if(m==="Atmosphere")w.visible=!0,fe.set(1);else if(m==="Chunk"){const X=new $(-.4,.4,.4);w.visible=!0,ye?w.position.set(...X.toArray()):(me.set(X.x),Ee.set(X.y),we.set(X.z))}else m==="EarthFull"&&C.visible?w.visible=!1:w.visible=!0;else if(be&&!q)if(m==="Atmosphere")fe.set(0);else if(m==="Chunk"){const X=new $(0,0,0);fn(X,C.position)&&(w.visible=!1),me.set(X.x),Ee.set(X.y),we.set(X.z)}else m==="EarthPartial"&&C.visible?w.visible=!0:w.visible=!1})},N=F=>{const Z=A.current[F].animations;ye||(u.current.forEach((w,m)=>{Z.find(C=>C.includes(m.toString()))||r.current.clipAction(w).reset().stop()}),u.current.length&&A.current[F].animations&&Z.forEach(w=>{const m=w.split(":"),C=u.current[Number(m[0])],q=r.current.clipAction(C);(!m[1]||m[1]!=="loop")&&(q.clampWhenFinished=!0,q.loop=zt),q.play()}))},x=F=>{K.current.forEach(w=>{w.hidden&&(w.element.dataset.hidden=!0,w.element.setAttribute("aria-hidden",!0))}),A.current[F].labels.forEach(w=>{K.current.filter(C=>C.text===w).forEach(C=>{C.element.dataset.hidden=!1,C.element.setAttribute("aria-hidden",!1)})})};requestAnimationFrame(()=>{const F=A.current.length-1,Z=Math.floor(D/v),w=rt(Z,0,F),m=A.current[w],C=A.current[w+1],q=Xe(m)||qe,be=Xe(C)||qe,X=(D-v*w)/v,Ae=rt(X,0,1),Ne=Ze(q.x,be.x,Ae),ve=Ze(q.y,be.y,Ae),Fe=Ze(q.z,be.z,Ae);if(U!==q&&A.current.length&&m&&(V(w),N(w),x(w)),U=q,!y){if(ye){a.current.position.set(Ne,ve,Fe);return}ne.set(Ne),ae.set(ve),ie.set(Fe)}})},[ne,ae,ie,me,Ee,we,y,_,fe,ye]);h.useEffect(()=>{const P=Gt(Ce,100);return f&&l&&window.addEventListener("scroll",P),()=>{window.removeEventListener("scroll",P)}},[Ce,l,f,fe]);const ke=h.useCallback(P=>{A.current=[...A.current,P]},[]),Ie=h.useCallback(P=>{A.current=A.current.filter(v=>v!==P)},[]);return se.jsx(lt.Provider,{value:{registerSection:ke,unregisterSection:Ie},children:se.jsxs("div",{className:ct(de.earth,W),ref:j,children:[se.jsxs("div",{className:de.viewport,children:[se.jsx("canvas",{className:de.canvas,"data-visible":f&&E,"data-grabbing":y,ref:H}),se.jsx("div",{className:de.labels,"aria-live":"polite",ref:ee}),se.jsx("div",{className:de.vignette})]}),se.jsx("div",{className:de.sections,children:T}),se.jsx(ht,{unmount:!0,in:!f&&z,timeout:mt(bt.base.durationL),children:P=>se.jsx(gt,{className:de.loader,"data-visible":P,children:se.jsx(ft,{})})})]})})},Ln=h.memo(({children:g,scrim:s,scrimReverse:_,className:e,camera:W=[0,0,0],animations:T=[],meshes:f=[],labels:c=[]})=>{const{registerSection:y,unregisterSection:B}=h.useContext(lt),E=h.useRef(),k=JSON.stringify(T)+JSON.stringify(W)+JSON.stringify(c)+JSON.stringify(f);return h.useEffect(()=>{const z={camera:W,animations:T,meshes:f,labels:c,sectionRef:E};return y(z),()=>{B(z)}},[k,y,B]),se.jsx("div",{className:ct(de.section,e),"data-scrim":s,"data-scrim-reverse":_,ref:E,children:g})});export{xn as Earth,Ln as EarthSection};
